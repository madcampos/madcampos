---
import type { Post } from '../utils/post';

import BaseLayout from '../layouts/Base.astro';
import PostCard from '../components/PostCard/index.astro';
import Pagination from '../components/Pagination/index.astro';
import SiteNav from '../components/SiteNav/index.astro';

import { BLOG_DESCRIPTION, BLOG_LOGO_MICRO_ALT, BLOG_TAGS, BLOG_TITLE, BLOG_URL } from '../constants';

import '../assets/css/pages/blog.css';

import blogSocialImage from '../assets/images/logo-blog-micro.png';

interface Props {
	posts: Post[],
	title?: string,
	baseUrl: string,
	currentUrl: string,
	currentPage: number,
	lastPage: number,
	prevUrl?: string,
	nextUrl?: string,
	start: number,
	end: number,
	total: number,
	size: number
}

const {
	title = '',
	posts,
	baseUrl, currentUrl,
	currentPage, lastPage,
	prevUrl, nextUrl,
	start, end, total, size
} = Astro.props;
---
<BaseLayout
	htmlTitle={[title, ...BLOG_TITLE].filter(Boolean)}
	title={title ?? BLOG_TITLE[0] ?? ''}
	description={BLOG_DESCRIPTION}
	tags={BLOG_TAGS}
	url={currentUrl}
	hasFeed={true}
	image={blogSocialImage.src}
	imageAlt={BLOG_LOGO_MICRO_ALT}
	pageSchema="Blog"
>
	<slot name="header" slot="header"></slot>

	<div id="posts-list">
		{posts.map((post) => (
			<PostCard
				url={`${BLOG_URL}${post.url}`}
				title={post.data.title}
				createdAt={post.data.createdAt.toISOString()}
				image={post.data.image}
				imageAlt={post.data.imageAlt}
				tags={post.data.tags}
			>
				<span slot="title">{post.data.title}</span>
				{post.data.summary}
			</PostCard>
		))}
	</div>

	<footer slot="footer">
		<Pagination
			baseUrl={baseUrl}
			currentPage={currentPage}
			lastPage={lastPage}
			prevUrl={prevUrl}
			nextUrl={nextUrl}
			start={start}
			end={end}
			total={total}
			size={size}
		/>

		<SiteNav />
	</footer>
</BaseLayout>
