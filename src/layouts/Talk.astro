---
import { TALKS_TAGS, TALKS_TITLE } from '../constants';

import InternalPage from '../layouts/InternalPage.astro';
import { Icon } from 'astro-icon/components';

import '../assets/css/pages/talks.css';

interface Props {
	title: string,
	description: string,
	url: string,

	image?: string,
	imageAlt?: string,

	event?: string,
	eventUrl?: string,
	date: Date,

	slides?: string,
	video?: string,
	code?: string,
	demo?: string,

	relatedContent?: {
		title: string,
		url: string
	}[],

	techStack?: string[]
}

const formatter = new Intl.DateTimeFormat('en-US', { dateStyle: 'long' });
const {
	title, description,
	url,
	event, eventUrl,
	date,
	slides, video, code, demo,
	relatedContent,
	techStack,
	image, imageAlt
} = Astro.props;
---
<InternalPage
	htmlTitle={[title, ...TALKS_TITLE]}
	title={title}
	description={description}
	url={url}
	tags={TALKS_TAGS}
	image={image}
	imageAlt={imageAlt}
	createdAt={date}
	pageSchema="EducationEvent"
>
	<span slot="header" itemprop="name">{title}</span>

	<slot></slot>

	<h2>
		<Icon name="uil:info-circle" title="Info sign" />
		Talk info
	</h2>
	<ul id="talk-info">
		{event && (
			<li>
				<strong>
					<Icon name="uil:presentation-play" title="Icon of a presentation board with a play symbol in it&apos;s center." />
					Event:
				</strong>
				<span itemprop="superEvent">
					{eventUrl ? (<a href={eventUrl} rel="noopener noreferrer">{event}</a>) : event}
				</span>
			</li>
		)}

		<li>
			<strong>
				<Icon name="uil:calendar-alt" title="Icon of a calendar" />
				Date:
			</strong>
			<time datetime={date.toISOString()} itemprop="startDate">{formatter.format(date)}</time>
		</li>

		{slides && (
			<li>
				<strong>
					<Icon name="uil:clapper-board" title="Icon of a clapper board, representing a slide presentation." />
					Slides:
				</strong>
				<a href={slides} rel="noopener noreferrer">{slides}</a>
			</li>
		)}

		{video && (
			<li>
				<strong>
					<Icon name="uil:video" title="Icon of a video camera" />
					Video:
				</strong>
				<a href={video} rel="noopener noreferrer">{video}</a>
			</li>
		)}

		{code && (
			<li>
				<strong>
					<Icon name="uil:brackets-curly" title="Icon of a code snippet" />
					Code:
				</strong>
				<a href={code} rel="noopener noreferrer">{code}</a>
			</li>
		)}
	</ul>

	{relatedContent && (
		<Fragment>
			<h2>
				<Icon name="uil:file-share-alt" title="Icon of a file with a sharing badge" />
				Related content
			</h2>
			<ul id="related-content">
				{relatedContent?.map(({ url: contentUrl, title: contentTitle }) => (
					<li>
						<a href={contentUrl} rel="noopener noreferrer">{contentTitle}</a>
					</li>
				))}
			</ul>
		</Fragment>
	)}

	<h2>
		<Icon name="uil:cog" title="Icon of a cog" />
		Technologies used
	</h2>
	<ul id="technology-tags">
		{techStack?.map((tech) => (
			<li class="tag">{tech}</li>
		))}
	</ul>

	{demo && (
		<Fragment>
			<h2>
				<Icon name="uil:flask" title="Icon of a chemistry flask" />
				Demo
			</h2>

			<iframe
				src={demo}
				loading="lazy"
				referrerpolicy="no-referrer"
				sandbox="allow-forms allow-scripts allow-same-origin"
				title={`Demo for ${title}`}
			>
				A local running demo of the project.
			</iframe>
		</Fragment>
	)}
</InternalPage>
